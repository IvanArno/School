{% extends 'culture/base.html' %}
{% load static %}
{% load video_filters %}

{% block content %}
<div style="max-width: 800px; margin: 0 auto;">
    <a href="{% url 'performances' %}" class="btn" style="margin-bottom: 1rem;">‚Üê –ù–∞–∑–∞–¥ –∫ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è–º</a>
    
    <div class="card">
        <div class="card-content">
            <h1 style="color: #2c3e50; margin-bottom: 1rem;">{{ performance.title }}</h1>
            
            <!-- –¢–æ–ª—å–∫–æ –¥–∞—Ç–∞, –±–µ–∑ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏—è –∏ –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ -->
            <div style="display: flex; gap: 1rem; margin-bottom: 1.5rem; flex-wrap: wrap;">
                <div style="background: #ecf0f1; padding: 0.5rem 1rem; border-radius: 4px;">
                    üìÖ <strong>–î–∞—Ç–∞ —Å–æ–±—ã—Ç–∏—è:</strong> {{ performance.date|date:"d.m.Y H:i" }}
                </div>
            </div>
            
            <!-- –í–∏–¥–µ–æ —Å–µ–∫—Ü–∏—è -->
            {% if performance.video_url or performance.video_file %}
            <div style="margin: 2rem 0;">
                <h3 style="color: #2c3e50; margin-bottom: 1rem;">–í–∏–¥–µ–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è</h3>
                
                {% if performance.video_url %}
                    {% if 'youtube.com' in performance.video_url or 'youtu.be' in performance.video_url %}
                        <!-- YouTube –≤–∏–¥–µ–æ -->
                        <div class="video-container">
                            <iframe 
                                src="{{ performance.video_url|youtube_embed }}" 
                                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                                allowfullscreen>
                            </iframe>
                        </div>
                    {% elif 'vimeo.com' in performance.video_url %}
                        <!-- Vimeo –≤–∏–¥–µ–æ -->
                        <div class="video-container">
                            <iframe 
                                src="{{ performance.video_url|vimeo_embed }}" 
                                allow="autoplay; fullscreen; picture-in-picture" 
                                allowfullscreen>
                            </iframe>
                        </div>
                    {% else %}
                        <!-- –î—Ä—É–≥–æ–µ –≤–∏–¥–µ–æ (–ø—Ä–æ—Å—Ç–∞—è —Å—Å—ã–ª–∫–∞) -->
                        <div style="padding: 2rem; background: #f8f9fa; border-radius: 8px; text-align: center;">
                            <p>–í–∏–¥–µ–æ –¥–æ—Å—Ç—É–ø–Ω–æ –ø–æ —Å—Å—ã–ª–∫–µ:</p>
                            <a href="{{ performance.video_url }}" target="_blank" class="btn">
                                –°–º–æ—Ç—Ä–µ—Ç—å –≤–∏–¥–µ–æ
                            </a>
                        </div>
                    {% endif %}
                
                {% elif performance.video_file %}
                    <!-- –ó–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–µ –≤–∏–¥–µ–æ -->
                    <div class="video-container">
                        <video controls>
                            <source src="{{ performance.video_file.url }}" type="video/mp4">
                            –í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –≤–∏–¥–µ–æ.
                            <a href="{{ performance.video_file.url }}">–°–∫–∞—á–∞—Ç—å –≤–∏–¥–µ–æ</a>
                        </video>
                    </div>
                {% endif %}
                
                {% if performance.video_caption %}
                <p style="margin-top: 0.5rem; color: #666; font-style: italic;">
                    {{ performance.video_caption }}
                </p>
                {% endif %}
            </div>
            {% endif %}
            
            <!-- –û–ø–∏—Å–∞–Ω–∏–µ -->
            <div style="margin: 2rem 0;">
                <h3 style="color: #2c3e50; margin-bottom: 1rem;">–û–ø–∏—Å–∞–Ω–∏–µ</h3>
                <div style="line-height: 1.8; font-size: 1.1rem;">
                    {{ performance.description|linebreaks }}
                </div>
            </div>
            
            <!-- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
            <div style="background: #f8f9fa; padding: 1.5rem; border-radius: 8px; margin-top: 2rem;">
                <h3 style="color: #2c3e50; margin-bottom: 1rem;">–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
                <ul style="list-style: none; padding: 0;">
                    <li style="margin-bottom: 0.5rem; padding-left: 1.5rem; position: relative;">
                        <span style="position: absolute; left: 0;">üìÖ</span>
                        <strong>–î–∞—Ç–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è:</strong> {{ performance.created_at|date:"d.m.Y" }}
                    </li>
                </ul>
            </div>
        </div>
    </div>
</div>
{% endblock %} 