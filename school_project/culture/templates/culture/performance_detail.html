{% extends 'culture/base.html' %}

{% block content %}
<div style="max-width: 800px; margin: 0 auto;">
    <a href="{% url 'performances' %}" class="btn" style="margin-bottom: 1rem;">‚Üê –ù–∞–∑–∞–¥ –∫ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è–º</a>
    
    <div class="card">
        <div class="card-content">
            <h1 style="color: #2c3e50; margin-bottom: 1rem;">{{ performance.title }}</h1>
            
            <div style="background: #ecf0f1; padding: 0.5rem 1rem; border-radius: 4px; display: inline-block; margin-bottom: 1.5rem;">
                üìÖ <strong>–î–∞—Ç–∞:</strong> {{ performance.date|date:"d.m.Y H:i" }}
            </div>
            
            <!-- –í–∏–¥–µ–æ —Å–µ–∫—Ü–∏—è -->
            {% if performance.video_url %}
                {% if 'youtube.com' in performance.video_url or 'youtu.be' in performance.video_url %}
                    <!-- YouTube –≤–∏–¥–µ–æ -->
                    <div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; border-radius: 8px; margin: 2rem 0;">
                        {% if 'youtube.com/watch?v=' in performance.video_url %}
                            {% with performance.video_url|slice:"32:" as video_id %}
                                <iframe 
                                    src="https://www.youtube.com/embed/{{ video_id }}" 
                                    style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: none;" 
                                    allowfullscreen>
                                </iframe>
                            {% endwith %}
                        {% elif 'youtu.be/' in performance.video_url %}
                            {% with performance.video_url|slice:"17:" as video_id %}
                                <iframe 
                                    src="https://www.youtube.com/embed/{{ video_id }}" 
                                    style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: none;" 
                                    allowfullscreen>
                                </iframe>
                            {% endwith %}
                        {% endif %}
                    </div>
                {% elif 'vimeo.com' in performance.video_url %}
                    <!-- Vimeo –≤–∏–¥–µ–æ -->
                    <div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; border-radius: 8px; margin: 2rem 0;">
                        {% with performance.video_url|slice:"18:" as video_id %}
                            <iframe 
                                src="https://player.vimeo.com/video/{{ video_id }}" 
                                style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: none;" 
                                allowfullscreen>
                            </iframe>
                        {% endwith %}
                    </div>
                {% endif %}
            {% elif performance.video_file %}
                <!-- –ó–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–µ –≤–∏–¥–µ–æ -->
                <div style="margin: 2rem 0;">
                    <video controls style="width: 100%; border-radius: 8px;">
                        <source src="{{ performance.video_file.url }}" type="video/mp4">
                        –í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤–∏–¥–µ–æ.
                    </video>
                </div>
            {% endif %}
            
            <!-- –û–ø–∏—Å–∞–Ω–∏–µ -->
            <div style="margin: 2rem 0;">
                <h3 style="color: #2c3e50; margin-bottom: 1rem;">–û–ø–∏—Å–∞–Ω–∏–µ</h3>
                <div style="line-height: 1.8;">
                    {{ performance.description|linebreaks }}
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}